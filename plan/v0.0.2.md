# VSCode Semantic Search Extension - v0.0.2

## Overview

Build upon v0.0.1 foundation to add incremental indexing, configuration options, and improved user experience.

## Goals

- Improve indexing performance with incremental updates
- Add user configuration options
- Enhance search experience with filtering
- Add persistence for ChromaDB data

## Features

### 1. Incremental Indexing
- [ ] Watch for file changes using `vscode.workspace.onDidSaveTextDocument`
- [ ] Auto-reindex modified files on save (configurable)
- [ ] Batch reindex for multiple changes
- [ ] Smart detection of renamed/moved files

### 2. Configuration Settings
- [ ] `semanticSearch.autoIndex`: Enable/disable auto-indexing on file save
- [ ] `semanticSearch.chunkSize`: Number of lines per chunk (default: 50)
- [ ] `semanticSearch.chunkOverlap`: Overlap between chunks (default: 10)
- [ ] `semanticSearch.maxResults`: Default number of search results (default: 10)
- [ ] `semanticSearch.excludePatterns`: Additional patterns to exclude
- [ ] `semanticSearch.includePatterns`: Additional patterns to include

### 3. Persistent ChromaDB Storage
- [ ] Implement local persistent storage for ChromaDB
- [ ] Handle extension restart without losing index
- [ ] Add migration support for schema changes

### 4. Enhanced Search UI
- [ ] Search results webview with syntax highlighting
- [ ] Filter by file type
- [ ] Filter by folder/path
- [ ] Sort by relevance or file path
- [ ] Preview snippets with context

### 5. Status Bar Integration
- [ ] Show indexing status in status bar
- [ ] Click to show detailed progress
- [ ] Indicator for stale index

### 6. Improved Index Sidebar
- [ ] Group files by folder
- [ ] Show file type icons
- [ ] Context menu for reindex single file
- [ ] Show chunk count per file
- [ ] Collapsible workspace sections

### 7. Performance Optimizations
- [ ] Parallel file reading during indexing
- [ ] Batch ChromaDB insertions
- [ ] Cache embedding results
- [ ] Limit concurrent operations

## Technical Tasks

### ChromaDB Persistence
```typescript
// Use chromadb with persistent client
const { ChromaClient } = require('chromadb');
const client = new ChromaClient({
    path: storagePath // Local persistent path
});
```

### File Watcher Implementation
```typescript
// Watch for file changes
vscode.workspace.onDidSaveTextDocument(async (document) => {
    if (config.autoIndex && shouldIndexFile(document.uri.fsPath)) {
        await indexingService.indexFile(document.uri, workspacePath);
    }
});
```

### Configuration Schema
```json
{
    "semanticSearch.autoIndex": {
        "type": "boolean",
        "default": false,
        "description": "Automatically reindex files on save"
    },
    "semanticSearch.chunkSize": {
        "type": "number",
        "default": 50,
        "description": "Number of lines per chunk"
    }
}
```

## Migration Notes

- Existing indices should continue to work
- New configuration options should have sensible defaults
- No breaking changes to existing commands

## Testing Checklist

- [ ] Incremental indexing works correctly
- [ ] File watcher triggers on save
- [ ] Configuration changes apply immediately
- [ ] Search filters work as expected
- [ ] Status bar updates correctly
- [ ] Index persists across extension restarts
- [ ] Performance is acceptable for large workspaces (1000+ files)

## Dependencies

No new dependencies required. Existing:
- `chromadb` - Vector database
- `chromadb-default-embed` - Embedding model
- `duckdb` - Metadata storage
- `minimatch` - Pattern matching
