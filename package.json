{
  "name": "semantic-search",
  "displayName": "Semantic Search",
  "description": "Provide local semantic search for VsCode to make LLM happy",
  "version": "0.0.6",
  "engines": {
    "vscode": "^1.106.1"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "semantic-search.buildIndex",
        "title": "Build Index",
        "category": "Semantic Search",
        "icon": "$(database)"
      },
      {
        "command": "semantic-search.indexFiles",
        "title": "Index Files/Folders",
        "category": "Semantic Search",
        "icon": "$(file-add)"
      },
      {
        "command": "semantic-search.search",
        "title": "Search",
        "category": "Semantic Search",
        "icon": "$(search)"
      },
      {
        "command": "semantic-search.searchWithPanel",
        "title": "Search (Rich Results Panel)",
        "category": "Semantic Search",
        "icon": "$(search-view-icon)"
      },
      {
        "command": "semantic-search.quickSearch",
        "title": "Quick Search (Open Top Result)",
        "category": "Semantic Search",
        "icon": "$(search-fuzzy)"
      },
      {
        "command": "semantic-search.deleteIndex",
        "title": "Delete Index",
        "category": "Semantic Search",
        "icon": "$(trash)"
      },
      {
        "command": "semantic-search.deleteFileIndex",
        "title": "Delete File Index",
        "category": "Semantic Search",
        "icon": "$(trash)"
      },
      {
        "command": "semantic-search.refreshIndex",
        "title": "Refresh Index View",
        "category": "Semantic Search",
        "icon": "$(refresh)"
      },
      {
        "command": "semantic-search.reindexFile",
        "title": "Reindex File",
        "category": "Semantic Search",
        "icon": "$(sync)"
      },
      {
        "command": "semantic-search.toggleGroupByFolder",
        "title": "Toggle Group by Folder",
        "category": "Semantic Search",
        "icon": "$(list-tree)"
      },
      {
        "command": "semantic-search.focusSearchInput",
        "title": "Focus Search Input",
        "category": "Semantic Search",
        "icon": "$(search)"
      },
      {
        "command": "semantic-search.clearSearchResults",
        "title": "Clear Search Results",
        "category": "Semantic Search",
        "icon": "$(clear-all)"
      },
      {
        "command": "semantic-search.openSearchInPanel",
        "title": "Open Search in Panel",
        "category": "Semantic Search",
        "icon": "$(link-external)"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "semanticSearch",
          "title": "Semantic Search",
          "icon": "$(search-fuzzy)"
        }
      ]
    },
    "views": {
      "semanticSearch": [
        {
          "type": "webview",
          "id": "semanticSearchSidebar",
          "name": "Search",
          "contextualTitle": "Semantic Search",
          "icon": "$(search)"
        }
      ],
      "explorer": [
        {
          "id": "semanticSearchIndex",
          "name": "Semantic Search Index",
          "icon": "$(search)",
          "contextualTitle": "Semantic Search Index"
        }
      ]
    },
    "menus": {
      "view/title": [
        {
          "command": "semantic-search.buildIndex",
          "when": "view == semanticSearchIndex",
          "group": "navigation@1"
        },
        {
          "command": "semantic-search.refreshIndex",
          "when": "view == semanticSearchIndex",
          "group": "navigation@2"
        },
        {
          "command": "semantic-search.toggleGroupByFolder",
          "when": "view == semanticSearchIndex",
          "group": "navigation@3"
        },
        {
          "command": "semantic-search.clearSearchResults",
          "when": "view == semanticSearchSidebar",
          "group": "navigation@1"
        },
        {
          "command": "semantic-search.openSearchInPanel",
          "when": "view == semanticSearchSidebar",
          "group": "navigation@2"
        }
      ],
      "view/item/context": [
        {
          "command": "semantic-search.reindexFile",
          "when": "view == semanticSearchIndex && viewItem == indexedFile",
          "group": "inline@1"
        },
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "view == semanticSearchIndex && viewItem == indexedFile",
          "group": "inline@2"
        }
      ],
      "explorer/context": [
        {
          "command": "semantic-search.indexFiles",
          "when": "explorerResourceIsFolder || resourceExtname",
          "group": "semanticSearch@1"
        },
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "resourceExtname",
          "group": "semanticSearch@2"
        }
      ],
      "commandPalette": [
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "false"
        }
      ]
    },
    "configuration": {
      "title": "Semantic Search",
      "properties": {
        "semanticSearch.autoIndex": {
          "type": "boolean",
          "default": false,
          "description": "Automatically reindex files on save"
        },
        "semanticSearch.indexing.chunkMaxTokens": {
          "type": "number",
          "default": 1024,
          "minimum": 256,
          "maximum": 2048,
          "description": "Maximum number of tokens per chunk for indexing"
        },
        "semanticSearch.indexing.chunkOverlapTokens": {
          "type": "number",
          "default": 256,
          "minimum": 0,
          "maximum": 2047,
          "description": "Number of overlapping tokens between chunks (must be less than max tokens)"
        },
        "semanticSearch.maxResults": {
          "type": "number",
          "default": 10,
          "minimum": 1,
          "maximum": 100,
          "description": "Default number of search results to return"
        },
        "semanticSearch.excludePatterns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "Additional glob patterns to exclude from indexing"
        },
        "semanticSearch.includePatterns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "Additional glob patterns to include in indexing"
        },
        "semanticSearch.logging.level": {
          "type": "string",
          "enum": [
            "error",
            "warn",
            "info",
            "debug"
          ],
          "default": "warn",
          "description": "Logging level for the Semantic Search extension"
        }
      }
    },
    "languageModelTools": [
      {
        "name": "semantic-search_ask",
        "displayName": "Semantic Search",
        "modelDescription": "Search for relevant code snippets in the workspace using semantic similarity. Returns file paths, line numbers, and code content. Use this when the user asks about code functionality, wants to find implementations, or needs to locate specific features in the codebase.",
        "icon": "$(search)",
        "canBeReferencedInPrompt": true,
        "toolReferenceName": "semanticSearch",
        "inputSchema": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "The search query describing what code or functionality to find"
            },
            "maxResults": {
              "type": "number",
              "description": "Maximum number of results to return (default: 10)",
              "default": 10
            }
          },
          "required": [
            "query"
          ]
        }
      }
    ],
    "keybindings": [
      {
        "command": "semantic-search.focusSearchInput",
        "key": "ctrl+shift+s",
        "mac": "cmd+shift+s"
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "tsc -p ./ && npm run copy-templates",
    "copy-templates": "node -e \"require('fs').cpSync('src/views/templates', 'out/views/templates', {recursive: true})\"",
    "watch": "tsc -watch -p ./",
    "pretest": "npm run compile && npm run lint",
    "lint": "eslint src",
    "test": "vscode-test"
  },
  "dependencies": {
    "@duckdb/node-api": "^1.4.2-r.1",
    "@duckdb/node-bindings": "^1.4.2-r.1",
    "@huggingface/transformers": "^3.0.0",
    "js-tiktoken": "^1.0.14",
    "minimatch": "^10.0.1"
  },
  "devDependencies": {
    "@types/glob": "^8.1.0",
    "@types/mocha": "^10.0.10",
    "@types/node": "22.x",
    "@types/vscode": "^1.106.1",
    "@vscode/test-cli": "^0.0.12",
    "@vscode/test-electron": "^2.5.2",
    "eslint": "^9.39.1",
    "glob": "^13.0.0",
    "mocha": "^11.7.5",
    "typescript": "^5.9.3",
    "typescript-eslint": "^8.48.1"
  }
}
