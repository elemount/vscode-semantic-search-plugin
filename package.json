{
  "name": "semantic-search",
  "displayName": "Semantic Search",
  "description": "Provide local semantic search for VsCode to make LLM happy",
  "version": "0.0.1",
  "engines": {
    "vscode": "^1.106.1"
  },
  "categories": [
    "Other"
  ],
  "activationEvents": [
    "onStartupFinished"
  ],
  "main": "./out/extension.js",
  "contributes": {
    "commands": [
      {
        "command": "semantic-search.buildIndex",
        "title": "Build Index",
        "category": "Semantic Search",
        "icon": "$(database)"
      },
      {
        "command": "semantic-search.indexFiles",
        "title": "Index Files/Folders",
        "category": "Semantic Search",
        "icon": "$(file-add)"
      },
      {
        "command": "semantic-search.search",
        "title": "Search",
        "category": "Semantic Search",
        "icon": "$(search)"
      },
      {
        "command": "semantic-search.searchWithPanel",
        "title": "Search (Rich Results Panel)",
        "category": "Semantic Search",
        "icon": "$(search-view-icon)"
      },
      {
        "command": "semantic-search.quickSearch",
        "title": "Quick Search (Open Top Result)",
        "category": "Semantic Search",
        "icon": "$(search-fuzzy)"
      },
      {
        "command": "semantic-search.deleteIndex",
        "title": "Delete Index",
        "category": "Semantic Search",
        "icon": "$(trash)"
      },
      {
        "command": "semantic-search.deleteFileIndex",
        "title": "Delete File Index",
        "category": "Semantic Search",
        "icon": "$(trash)"
      },
      {
        "command": "semantic-search.refreshIndex",
        "title": "Refresh Index View",
        "category": "Semantic Search",
        "icon": "$(refresh)"
      },
      {
        "command": "semantic-search.showServerLogs",
        "title": "Show Server Logs",
        "category": "Semantic Search",
        "icon": "$(output)"
      },
      {
        "command": "semantic-search.restartServer",
        "title": "Restart Chroma Server",
        "category": "Semantic Search",
        "icon": "$(debug-restart)"
      },
      {
        "command": "semantic-search.reindexFile",
        "title": "Reindex File",
        "category": "Semantic Search",
        "icon": "$(sync)"
      },
      {
        "command": "semantic-search.toggleGroupByFolder",
        "title": "Toggle Group by Folder",
        "category": "Semantic Search",
        "icon": "$(list-tree)"
      }
    ],
    "views": {
      "explorer": [
        {
          "id": "semanticSearchIndex",
          "name": "Semantic Search Index",
          "icon": "$(search)",
          "contextualTitle": "Semantic Search Index"
        }
      ]
    },
    "menus": {
      "view/title": [
        {
          "command": "semantic-search.buildIndex",
          "when": "view == semanticSearchIndex",
          "group": "navigation@1"
        },
        {
          "command": "semantic-search.refreshIndex",
          "when": "view == semanticSearchIndex",
          "group": "navigation@2"
        },
        {
          "command": "semantic-search.toggleGroupByFolder",
          "when": "view == semanticSearchIndex",
          "group": "navigation@3"
        }
      ],
      "view/item/context": [
        {
          "command": "semantic-search.reindexFile",
          "when": "view == semanticSearchIndex && viewItem == indexedFile",
          "group": "inline@1"
        },
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "view == semanticSearchIndex && viewItem == indexedFile",
          "group": "inline@2"
        }
      ],
      "explorer/context": [
        {
          "command": "semantic-search.indexFiles",
          "when": "explorerResourceIsFolder || resourceExtname",
          "group": "semanticSearch@1"
        },
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "resourceExtname",
          "group": "semanticSearch@2"
        }
      ],
      "commandPalette": [
        {
          "command": "semantic-search.deleteFileIndex",
          "when": "false"
        },
        {
          "command": "semantic-search.showServerLogs",
          "when": "true"
        }
      ]
    },
    "configuration": {
      "title": "Semantic Search",
      "properties": {
        "semanticSearch.autoIndex": {
          "type": "boolean",
          "default": false,
          "description": "Automatically reindex files on save"
        },
        "semanticSearch.chunkSize": {
          "type": "number",
          "default": 50,
          "minimum": 10,
          "maximum": 500,
          "description": "Number of lines per chunk for indexing"
        },
        "semanticSearch.chunkOverlap": {
          "type": "number",
          "default": 10,
          "minimum": 0,
          "maximum": 50,
          "description": "Number of overlapping lines between chunks"
        },
        "semanticSearch.maxResults": {
          "type": "number",
          "default": 10,
          "minimum": 1,
          "maximum": 100,
          "description": "Default number of search results to return"
        },
        "semanticSearch.excludePatterns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "Additional glob patterns to exclude from indexing"
        },
        "semanticSearch.includePatterns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": [],
          "description": "Additional glob patterns to include in indexing"
        },
        "semanticSearch.chroma.port": {
          "type": "number",
          "default": 0,
          "minimum": 0,
          "maximum": 65535,
          "description": "Port for Chroma server (0 = auto-assign)"
        },
        "semanticSearch.chroma.logLevel": {
          "type": "string",
          "enum": [
            "debug",
            "info",
            "warning",
            "error"
          ],
          "default": "warning",
          "description": "Chroma server log level"
        },
        "semanticSearch.chroma.startupTimeout": {
          "type": "number",
          "default": 30000,
          "minimum": 5000,
          "maximum": 120000,
          "description": "Timeout in milliseconds for Chroma server to start"
        }
      }
    },
    "languageModelTools": [
      {
        "name": "semantic-search_semanticSearch",
        "displayName": "Semantic Search",
        "description": "Search for relevant code snippets using semantic similarity. Use this to find code related to a concept or description.",
        "modelDescription": "Search for relevant code snippets in the workspace using semantic similarity. Returns file paths, line numbers, and code content. Use this when the user asks about code functionality, wants to find implementations, or needs to locate specific features in the codebase.",
        "icon": "$(search)",
        "canBeReferencedInPrompt": true,
        "inputSchema": {
          "type": "object",
          "properties": {
            "query": {
              "type": "string",
              "description": "The search query describing what code or functionality to find"
            },
            "maxResults": {
              "type": "number",
              "description": "Maximum number of results to return (default: 10)",
              "default": 10
            }
          },
          "required": [
            "query"
          ]
        }
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run compile",
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "pretest": "npm run compile && npm run lint",
    "lint": "eslint src",
    "test": "vscode-test"
  },
  "dependencies": {
    "@duckdb/node-api": "^1.4.2-r.1",
    "@duckdb/node-bindings": "^1.4.2-r.1",
    "chromadb": "^1.10.5",
    "chromadb-default-embed": "^2.13.2",
    "minimatch": "^10.0.1"
  },
  "devDependencies": {
    "@types/mocha": "^10.0.10",
    "@types/node": "22.x",
    "@types/vscode": "^1.106.1",
    "@vscode/test-cli": "^0.0.12",
    "@vscode/test-electron": "^2.5.2",
    "eslint": "^9.39.1",
    "typescript": "^5.9.3",
    "typescript-eslint": "^8.48.1"
  }
}
